"use strict";
/// <reference types="aws-sdk" />
const AWS = require("aws-sdk");
const tableName = process.env.TABLE_NAME || "";
const dynamo = new AWS.DynamoDB.DocumentClient();
const createResponse = (body, statusCode = 200) => {
    return {
        statusCode,
        body: JSON.stringify(body, null, 2)
    };
};
const getAllEmails = async () => {
    const scanResult = await dynamo
        .scan({
        TableName: tableName
    })
        .promise();
    return scanResult;
};
exports.handler = async function (event) {
    try {
        const { httpMethod, body } = event;
        if (httpMethod === "GET") {
            const response = await getAllEmails();
            return createResponse(response.Items || []);
        }
        return createResponse(`We only accept GET requests for now, not ${httpMethod}`, 500);
    }
    catch (error) {
        console.log(error);
        return createResponse(error, 500);
    }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZW1haWxDYXB0dXJlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiZW1haWxDYXB0dXJlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxpQ0FBaUM7QUFDakMsTUFBTSxHQUFHLEdBQUcsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBRS9CLE1BQU0sU0FBUyxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsVUFBVSxJQUFJLEVBQUUsQ0FBQztBQUMvQyxNQUFNLE1BQU0sR0FBRyxJQUFJLEdBQUcsQ0FBQyxRQUFRLENBQUMsY0FBYyxFQUFFLENBQUM7QUFFakQsTUFBTSxjQUFjLEdBQUcsQ0FDbkIsSUFBbUQsRUFDbkQsVUFBVSxHQUFHLEdBQUcsRUFDbEIsRUFBRTtJQUNBLE9BQU87UUFDSCxVQUFVO1FBQ1YsSUFBSSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7S0FDdEMsQ0FBQztBQUNOLENBQUMsQ0FBQztBQUVGLE1BQU0sWUFBWSxHQUFHLEtBQUssSUFBSSxFQUFFO0lBQzVCLE1BQU0sVUFBVSxHQUFHLE1BQU0sTUFBTTtTQUMxQixJQUFJLENBQUM7UUFDRixTQUFTLEVBQUUsU0FBUztLQUN2QixDQUFDO1NBQ0QsT0FBTyxFQUFFLENBQUM7SUFFZixPQUFPLFVBQVUsQ0FBQztBQUN0QixDQUFDLENBQUM7QUFFRixPQUFPLENBQUMsT0FBTyxHQUFHLEtBQUssV0FBVyxLQUFnQztJQUM5RCxJQUFJO1FBQ0EsTUFBTSxFQUFFLFVBQVUsRUFBRSxJQUFJLEVBQUMsR0FBRyxLQUFLLENBQUM7UUFFbEMsSUFBSSxVQUFVLEtBQUssS0FBSyxFQUFFO1lBQ3RCLE1BQU0sUUFBUSxHQUFHLE1BQU0sWUFBWSxFQUFFLENBQUM7WUFFdEMsT0FBTyxjQUFjLENBQUMsUUFBUSxDQUFDLEtBQUssSUFBSSxFQUFFLENBQUMsQ0FBQztTQUMvQztRQUNELE9BQU8sY0FBYyxDQUNqQiw0Q0FBNEMsVUFBVSxFQUFFLEVBQ3hELEdBQUcsQ0FDTixDQUFDO0tBQ0w7SUFBQyxPQUFPLEtBQUssRUFBRTtRQUNaLE9BQU8sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDbkIsT0FBTyxjQUFjLENBQUMsS0FBSyxFQUFFLEdBQUcsQ0FBQyxDQUFDO0tBQ3JDO0FBQ0wsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8vIDxyZWZlcmVuY2UgdHlwZXM9XCJhd3Mtc2RrXCIgLz5cbmNvbnN0IEFXUyA9IHJlcXVpcmUoXCJhd3Mtc2RrXCIpO1xuXG5jb25zdCB0YWJsZU5hbWUgPSBwcm9jZXNzLmVudi5UQUJMRV9OQU1FIHx8IFwiXCI7XG5jb25zdCBkeW5hbW8gPSBuZXcgQVdTLkR5bmFtb0RCLkRvY3VtZW50Q2xpZW50KCk7XG5cbmNvbnN0IGNyZWF0ZVJlc3BvbnNlID0gKFxuICAgIGJvZHk6IHN0cmluZyB8IEFXUy5EeW5hbW9EQi5Eb2N1bWVudENsaWVudC5JdGVtTGlzdCxcbiAgICBzdGF0dXNDb2RlID0gMjAwXG4pID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgICBzdGF0dXNDb2RlLFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShib2R5LCBudWxsLCAyKVxuICAgIH07XG59O1xuXG5jb25zdCBnZXRBbGxFbWFpbHMgPSBhc3luYyAoKSA9PiB7XG4gICAgY29uc3Qgc2NhblJlc3VsdCA9IGF3YWl0IGR5bmFtb1xuICAgICAgICAuc2Nhbih7XG4gICAgICAgICAgICBUYWJsZU5hbWU6IHRhYmxlTmFtZVxuICAgICAgICB9KVxuICAgICAgICAucHJvbWlzZSgpO1xuXG4gICAgcmV0dXJuIHNjYW5SZXN1bHQ7XG59O1xuXG5leHBvcnRzLmhhbmRsZXIgPSBhc3luYyBmdW5jdGlvbiAoZXZlbnQ6IEFXU0xhbWJkYS5BUElHYXRld2F5RXZlbnQpIHtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCB7IGh0dHBNZXRob2QsIGJvZHl9ID0gZXZlbnQ7XG5cbiAgICAgICAgaWYgKGh0dHBNZXRob2QgPT09IFwiR0VUXCIpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZ2V0QWxsRW1haWxzKCk7XG5cbiAgICAgICAgICAgIHJldHVybiBjcmVhdGVSZXNwb25zZShyZXNwb25zZS5JdGVtcyB8fCBbXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNyZWF0ZVJlc3BvbnNlKFxuICAgICAgICAgICAgYFdlIG9ubHkgYWNjZXB0IEdFVCByZXF1ZXN0cyBmb3Igbm93LCBub3QgJHtodHRwTWV0aG9kfWAsXG4gICAgICAgICAgICA1MDBcbiAgICAgICAgKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgIHJldHVybiBjcmVhdGVSZXNwb25zZShlcnJvciwgNTAwKTtcbiAgICB9XG59OyJdfQ==